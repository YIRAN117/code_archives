#cat /Users/yiranli/Dropbox/Functional_Annotation/Cpar_BMGF/Cpar_BMGF.gff |awk '{a[++A]=$1;b[++B]=$2;c[++C]=$3;d[++D]=$4;e[++E]=$5;f[++F]=$6;g[++G]=$7;h[++H]=$8;i[++I]=$9} /stop_codon/ {if (c[NR-2]=="CDS" && c[NR-1]="start_codon") print a[NR]"\t"b[NR]"\tgene\t"d[NR-1]"\t"e[NR]"\t"f[NR]"\t"g[NR-2]"\t"h[NR]"\t"i[NR-2]}'
minusplus="$(cat /Users/yiranli/Dropbox/Functional_Annotation/Cpar_BMGF/Cpar_BMGF.gff|awk '{a[++A]=$1;b[++B]=$2;c[++C]=$3;d[++D]=$4;e[++E]=$5;f[++F]=$6;g[++G]=$7;h[++H]=$8;i[++I]=$9} /stop_codon/ {if (c[NR-2]=="CDS" && c[NR-1]="start_codon") print a[NR]"\t"b[NR]"\tgene\t"d[NR-1]"\t"e[NR]"\t"f[NR]"\t"g[NR-2]"\t"h[NR]"\t"i[NR-2]}'|gsort -V|awk '{if($7=="+") print$0;else print $1"\t"$2"\t"$3"\t"$5"\t"$4"\t"$6"\t"$7"\t"$8"\t"$9}'|awk '{j[++J]=$4;k[++K]=$5;m[++M]=$7;n[++N]=$1;}{if(NR>1 && n[NR]==n[NR-1]) print j[NR]-k[NR-1]"\t"m[NR-1]"\t"m[NR]}'|awk '{if($2=="-" && $3=="+") print $1}')"
minusminus="$(cat /Users/yiranli/Dropbox/Functional_Annotation/Cpar_BMGF/Cpar_BMGF.gff|awk '{a[++A]=$1;b[++B]=$2;c[++C]=$3;d[++D]=$4;e[++E]=$5;f[++F]=$6;g[++G]=$7;h[++H]=$8;i[++I]=$9} /stop_codon/ {if (c[NR-2]=="CDS" && c[NR-1]="start_codon") print a[NR]"\t"b[NR]"\tgene\t"d[NR-1]"\t"e[NR]"\t"f[NR]"\t"g[NR-2]"\t"h[NR]"\t"i[NR-2]}'|gsort -V|awk '{if($7=="+") print$0;else print $1"\t"$2"\t"$3"\t"$5"\t"$4"\t"$6"\t"$7"\t"$8"\t"$9}'|awk '{j[++J]=$4;k[++K]=$5;m[++M]=$7;n[++N]=$1;}{if(NR>1 && n[NR]==n[NR-1]) print j[NR]-k[NR-1]"\t"m[NR-1]"\t"m[NR]}'|awk '{if($2=="-" && $3=="-") print $1}')"
plusplus="$(cat /Users/yiranli/Dropbox/Functional_Annotation/Cpar_BMGF/Cpar_BMGF.gff|awk '{a[++A]=$1;b[++B]=$2;c[++C]=$3;d[++D]=$4;e[++E]=$5;f[++F]=$6;g[++G]=$7;h[++H]=$8;i[++I]=$9} /stop_codon/ {if (c[NR-2]=="CDS" && c[NR-1]="start_codon") print a[NR]"\t"b[NR]"\tgene\t"d[NR-1]"\t"e[NR]"\t"f[NR]"\t"g[NR-2]"\t"h[NR]"\t"i[NR-2]}'|gsort -V|awk '{if($7=="+") print$0;else print $1"\t"$2"\t"$3"\t"$5"\t"$4"\t"$6"\t"$7"\t"$8"\t"$9}'|awk '{j[++J]=$4;k[++K]=$5;m[++M]=$7;n[++N]=$1;}{if(NR>1 && n[NR]==n[NR-1]) print j[NR]-k[NR-1]"\t"m[NR-1]"\t"m[NR]}'|awk '{if($2=="+" && $3=="+") print $1}')"
plusminus="$(cat /Users/yiranli/Dropbox/Functional_Annotation/Cpar_BMGF/Cpar_BMGF.gff|awk '{a[++A]=$1;b[++B]=$2;c[++C]=$3;d[++D]=$4;e[++E]=$5;f[++F]=$6;g[++G]=$7;h[++H]=$8;i[++I]=$9} /stop_codon/ {if (c[NR-2]=="CDS" && c[NR-1]="start_codon") print a[NR]"\t"b[NR]"\tgene\t"d[NR-1]"\t"e[NR]"\t"f[NR]"\t"g[NR-2]"\t"h[NR]"\t"i[NR-2]}'|gsort -V|awk '{if($7=="+") print$0;else print $1"\t"$2"\t"$3"\t"$5"\t"$4"\t"$6"\t"$7"\t"$8"\t"$9}'|awk '{j[++J]=$4;k[++K]=$5;m[++M]=$7;n[++N]=$1;}{if(NR>1 && n[NR]==n[NR-1]) print j[NR]-k[NR-1]"\t"m[NR-1]"\t"m[NR]}'|awk '{if($2=="+" && $3=="-") print $1}')"
#UTR
cat /Users/yiranli/Desktop/OCT28/24h_transcript_integenicanalysis.gtf |awk '{if ($3=="transcript") print $0}'|grep "reference_id"|gsort -V|awk '{j[++J]=$4;k[++K]=$5;m[++M]=$7;n[++N]=$1;}{if(NR>1 && n[NR]==n[NR-1]) print j[NR]-k[NR-1]"\t"m[NR-1]"\t"m[NR]}'|awk '{if($2=="+" && $3=="-") print $1}'
